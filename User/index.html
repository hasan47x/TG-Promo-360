<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>TG Promo 360</title>

    <!-- Icons and Fonts -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Your Custom Stylesheet -->
    <link rel="stylesheet" href="style.css">

    <!-- Telegram Web App Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- Firebase v8 SDK Scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>

<body>
    <div id="globalLoader"><div class="spinner-border"></div></div>

    <!-- Authentication Area (Shown to logged-out web users) -->
    <div id="authContainer" class="auth-page-container" style="display: none;">
        
        <!-- Web Login Card -->
        <div class="login-card" id="webLoginCard">
            <h2 class="text-center mb-1">Welcome Back!</h2>
            <p class="text-center text-secondary mb-4">Sign in to your account</p>
            
            <form id="emailLoginForm">
                <div class="mb-3">
                    <label for="loginEmail" class="form-label">Email</label>
                    <input type="email" class="form-control" id="loginEmail" placeholder="you@example.com" required>
                </div>
                <div class="mb-3">
                    <label for="loginPassword" class="form-label">Password</label>
                    <input type="password" class="form-control" id="loginPassword" required>
                </div>
                <div class="d-grid gap-2">
                    <button type="submit" class="btn btn-primary btn-lg">Sign In</button>
                    <button type="button" class="btn btn-light btn-lg" id="googleSignInBtn"><i class="bi bi-google"></i> Sign in with Google</button>
                </div>
            </form>
            <div class="text-center mt-3">
                <p class="mb-1">New here? <a href="#" id="switchToSignup" class="auth-switch-link">Create an account</a></p>
                <p>Or <a href="#" id="switchToTgLoginFromLogin" class="auth-switch-link">Login with Telegram ID?</a></p>
            </div>
        </div>

        <!-- Web Signup Card -->
        <div class="login-card" id="webSignupCard" style="display: none;">
            <h2 class="text-center mb-1">Create Account</h2>
            <p class="text-center text-secondary mb-4">Get started with TG Promo 360</p>
            
            <form id="emailSignupForm">
                <div class="mb-3">
                    <label for="signupName" class="form-label">Full Name</label>
                    <input type="text" class="form-control" id="signupName" required>
                </div>
                 <div class="mb-3">
                    <label for="signupEmail" class="form-label">Email</label>
                    <input type="email" class="form-control" id="signupEmail" required>
                </div>
                <div class="mb-3">
                    <label for="signupPassword" class="form-label">Password</label>
                    <input type="password" class="form-control" id="signupPassword" required>
                </div>
                <div class="d-grid gap-2">
                    <button type="submit" class="btn btn-primary btn-lg">Sign Up</button>
                </div>
            </form>
            <div class="text-center mt-3">
                 <p>Already have an account? <a href="#" id="switchToLogin" class="auth-switch-link">Sign In</a></p>
            </div>
        </div>

        <!-- Telegram Login Card -->
        <div class="login-card" id="telegramLoginCard" style="display: none;">
             <h2 class="text-center mb-1">Telegram Login</h2>
            <p class="text-center text-secondary mb-4">Use the password you set in the bot.</p>
            <form id="telegramLoginForm">
                <div class="mb-3">
                    <label for="tgUsername" class="form-label">Telegram Username or ID</label>
                    <input type="text" class="form-control" id="tgUsername" placeholder="Your Telegram ID or Username" required>
                </div>
                <div class="mb-3">
                    <label for="tgPassword" class="form-label">Password</label>
                    <input type="password" class="form-control" id="tgPassword" required>
                </div>
                 <div class="d-grid">
                    <button type="submit" class="btn btn-primary btn-lg">Login</button>
                </div>
            </form>
             <div class="text-center mt-3">
                 <a href="#" id="switchToWebLogin" class="auth-switch-link">Login with Email/Google?</a>
            </div>
        </div>
    </div>
    
    <!-- Main App Container (Shown to logged-in users) -->
    <div id="appContainer" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <button class="header-menu-button" id="menuButton" data-bs-toggle="offcanvas" data-bs-target="#sideMenu">
                    <i class="bi bi-list"></i>
                </button>
                <span id="headerSectionTitle" class="header-section-title">Dashboard</span>
            </div>
            <div class="header-right">
                <button class="wallet-chip" id="headerWalletChip" data-section="wallet-section">
                    <i class="bi bi-coin"></i>
                    <span id="headerUserPoints">0</span>
                </button>
            </div>
        </header>

        <!-- Side Menu (Off-canvas) -->
        <div class="offcanvas offcanvas-start side-menu" tabindex="-1" id="sideMenu">
            <div class="offcanvas-header">
                <div class="d-flex align-items-center">
                    <img src="https://via.placeholder.com/45" alt="User" class="menu-user-pic" id="menuUserPic">
                    <div>
                        <h5 class="offcanvas-title" id="menuUserName">Guest</h5>
                        <small class="text-secondary" id="menuUserTgId">ID: ---</small>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
            </div>
            <div class="offcanvas-body">
                <ul class="menu-nav" id="sideNavMenu">
                    <!-- Menu items will be populated by JS -->
                </ul>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Sections for different pages -->
            <section id="home-section" class="section">
                <!-- JS will populate home content -->
            </section>
            
            <section id="create-post-section" class="section">
                <h2 class="section-title">Create New Post</h2>
                <div class="custom-card">
                    <form id="createPostForm">
                        <!-- Text Formatting Toolbar -->
                        <div class="text-editor-toolbar mb-2">
                            <button type="button" class="toolbar-btn" data-format="bold"><i class="bi bi-type-bold"></i></button>
                            <button type="button" class="toolbar-btn" data-format="italic"><i class="bi bi-type-italic"></i></button>
                            <button type="button" class="toolbar-btn" data-format="underline"><i class="bi bi-type-underline"></i></button>
                            <button type="button" class="toolbar-btn" data-format="strikethrough"><i class="bi bi-type-strikethrough"></i></button>
                            <button type="button" class="toolbar-btn" data-format="spoiler"><i class="bi bi-eye-slash"></i></button>
                            <button type="button" class="toolbar-btn" data-format="code"><i class="bi bi-code"></i></button>
                        </div>

                        <div class="mb-3">
                            <textarea class="form-control" id="postContent" rows="6" placeholder="Write your post here..."></textarea>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Select Tags (Up to 3)</label>
                            <div id="postTagsContainer" class="d-flex flex-wrap gap-2">
                                <!-- JS will populate tags here -->
                            </div>
                        </div>

                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" role="switch" id="addCustomButtonSwitch">
                                <label class="form-check-label" for="addCustomButtonSwitch">Add a Custom Button</label>
                            </div>
                            <div id="customButtonFields" class="mt-2" style="display: none;">
                                <div class="row g-2">
                                    <div class="col-md-6"><input type="text" class="form-control" id="buttonText" placeholder="Button Text"></div>
                                    <div class="col-md-6"><input type="url" class="form-control" id="buttonUrl" placeholder="https://your-link.com"></div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="form-label">Schedule Post</label>
                            <div class="btn-group w-100" role="group">
                                <input type="radio" class="btn-check" name="scheduleOption" id="postNow" value="now" autocomplete="off" checked>
                                <label class="btn btn-outline-primary" for="postNow">Post Now</label>

                                <input type="radio" class="btn-check" name="scheduleOption" id="postLater" value="later" autocomplete="off">
                                <label class="btn btn-outline-primary" for="postLater">Schedule for Later</label>
                            </div>
                            <div id="scheduleTimeFields" class="mt-2" style="display: none;">
                                <input type="datetime-local" class="form-control" id="scheduleDateTime">
                            </div>
                        </div>
                        
                        <div class="post-cost-summary alert alert-info text-center">Estimated Cost: <strong id="estimatedCost">100</strong> <i class="bi bi-coin"></i></div>
                        <button type="submit" class="btn btn-lg btn-custom-accent w-100" id="submitPostBtn"><i class="bi bi-send-fill"></i> Submit Post</button>
                    </form>
                </div>
            </section>

            <section id="posts-section" class="section">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h2 class="section-title mb-0">My Content</h2>
                    <button class="btn btn-sm btn-primary" id="navigateToCreatePostBtn" data-section="create-post-section"><i class="bi bi-plus-lg"></i> Create New Post</button>
                </div>
                <div id="myPostsContainer">
                    <!-- User's posts will be loaded here by JS -->
                </div>
            </section>

            <section id="earn-section" class="section">
                 <h2 class="section-title">Earn Points</h2>
                 <div class="list-group custom-card">
                    <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" id="dailyBonusLink">
                        <div><i class="bi bi-calendar-gift-fill me-3"></i> Daily Bonus</div>
                        <span class="badge rounded-pill" id="dailyBonusBadge"></span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-section="tasks-section">
                        <div><i class="bi bi-check-circle-fill me-3"></i> Join & Earn</div>
                        <i class="bi bi-chevron-right"></i>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-section="watch-ads-section">
                        <div><i class="bi bi-play-btn-fill me-3"></i> Watch Ads</div>
                        <i class="bi bi-chevron-right"></i>
                    </a>
                 </div>
            </section>

            <section id="profile-section" class="section">
                <div class="profile-header-card">
                    <img src="https://via.placeholder.com/80" alt="Avatar" class="profile-avatar" id="profileAvatar">
                    <h3 class="profile-name" id="profileName">User Name</h3>
                    <p class="profile-id" id="profileId">ID: 123456</p>
                </div>
                
                <div class="list-group custom-card">
                    <a href="#" class="list-group-item list-group-item-action" data-section="referral-section">
                        <div><i class="bi bi-person-plus-fill me-3"></i> Refer & Earn</div>
                        <i class="bi bi-chevron-right"></i>
                    </a>
                     <a href="#" class="list-group-item list-group-item-action" data-section="premium-section">
                        <div><i class="bi bi-award-fill me-3"></i> Go Premium</div>
                        <i class="bi bi-chevron-right"></i>
                    </a>
                </div>
                
                <div class="list-group custom-card mt-3" id="accountLinkingCard">
                    <a href="#" class="list-group-item list-group-item-action" id="connectGoogleLink" style="display: none;">
                        <div><i class="bi bi-google me-3"></i> Connect Google Account</div>
                        <i class="bi bi-chevron-right"></i>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" id="connectTelegramLink" style="display: none;">
                        <div><i class="bi bi-telegram me-3"></i> Connect Telegram Account</div>
                        <i class="bi bi-chevron-right"></i>
                    </a>
                    <div class="list-group-item" id="connectedGoogleAccount" style="display: none;">
                        <div class="d-flex align-items-center"><i class="bi bi-google me-3"></i> <span id="googleEmailSpan"></span></div>
                        <span class="badge bg-success">Connected</span>
                    </div>
                    <div class="list-group-item" id="connectedTelegramAccount" style="display: none;">
                        <div class="d-flex align-items-center"><i class="bi bi-telegram me-3"></i> <span id="telegramIdSpan"></span></div>
                        <span class="badge bg-success">Connected</span>
                    </div>
                </div>

                <div class="list-group custom-card mt-3">
                     <label class="list-group-item d-flex justify-content-between align-items-center">
                        <div><i class="bi bi-palette-fill me-3"></i> Dark Mode</div>
                        <div class="form-check form-switch"><input class="form-check-input" type="checkbox" role="switch" id="themeSwitch"></div>
                    </label>
                </div>
                 <div class="list-group custom-card mt-3">
                    <a href="#" class="list-group-item list-group-item-action" data-section="privacy-policy-section">
                        <div><i class="bi bi-shield-check me-3"></i> Privacy Policy</div>
                        <i class="bi bi-chevron-right"></i>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-section="terms-section">
                        <div><i class="bi bi-file-text-fill me-3"></i> Terms & Conditions</div>
                        <i class="bi bi-chevron-right"></i>
                    </a>
                 </div>

                 <div class="list-group custom-card mt-3">
                    <a href="#" class="list-group-item list-group-item-action text-danger" id="logoutButton">
                        <div><i class="bi bi-box-arrow-right me-3"></i> Logout</div>
                    </a>
                 </div>
            </section>
            
            <section id="wallet-section" class="section">
                 <h2 class="section-title">My Wallet</h2>
                <div class="custom-card text-center mb-4">
                    <p class="text-secondary mb-1">Current Balance</p>
                    <h1 class="display-4 fw-bold" id="walletPointsDisplay">0 <i class="bi bi-coin text-warning"></i></h1>
                </div>
                <div class="list-group custom-card">
                    <a href="#" class="list-group-item list-group-item-action" data-section="transactions-section">
                        <div><i class="bi bi-receipt-cutoff me-3"></i> Transaction History</div>
                        <i class="bi bi-chevron-right"></i>
                    </a>
                </div>
            </section>

            <section id="transactions-section" class="section">
                <h2 class="section-title">Transaction History</h2>
                <div id="transactionListContainer" class="list-group custom-card">
                    <!-- JS will populate transactions here -->
                </div>
            </section>

            <!-- Other Dynamic sections -->
            <section id="tasks-section" class="section">
                <h2 class="section-title">Join & Earn Tasks</h2>
                <div class="custom-card text-center">
                    <p class="text-secondary">New tasks will be available soon. Check back later!</p>
                </div>
            </section>
            <section id="referral-section" class="section">
                <h2 class="section-title">Refer & Earn</h2>
                <div class="custom-card text-center">
                    <p class="text-secondary">Your referral link and stats will appear here soon.</p>
                </div>
            </section>
            <section id="premium-section" class="section">
                 <h2 class="section-title">Go Premium</h2>
                <div class="custom-card text-center">
                    <p class="text-secondary">Premium subscription plans will be available here soon.</p>
                </div>
            </section>
            <section id="watch-ads-section" class="section">
                <h2 class="section-title">Watch Ads to Earn</h2>
                <div class="custom-card text-center">
                    <p class="text-secondary">The ad watching feature is coming soon!</p>
                </div>
            </section>
            <section id="privacy-policy-section" class="section">
                <h2 class="section-title">Privacy Policy</h2>
                <div class="custom-card">
                    <p>Your privacy is important to us. It is TG Promo 360's policy to respect your privacy regarding any information we may collect from you across our website, and other sites we own and operate.</p>
                    <p>We only ask for personal information when we truly need it to provide a service to you. We collect it by fair and lawful means, with your knowledge and consent. We also let you know why we’re collecting it and how it will be used.</p>
                    <p>We only retain collected information for as long as necessary to provide you with your requested service. What data we store, we’ll protect within commercially acceptable means to prevent loss and theft, as well as unauthorized access, disclosure, copying, use or modification.</p>
                </div>
            </section>
            <section id="terms-section" class="section">
                <h2 class="section-title">Terms & Conditions</h2>
                 <div class="custom-card">
                    <h5>1. Terms</h5>
                    <p>By accessing this web app, you are agreeing to be bound by these Terms and Conditions of Use, applicable laws and regulations and their compliance.</p>
                    <h5>2. Use License</h5>
                    <p>Permission is granted to temporarily download one duplicate of the materials (data or programming) on TG Promo 360's site for individual and non-business use only.</p>
                </div>
            </section>
        </main>
        
        <!-- Bottom Navigation Bar -->
        <nav class="bottom-nav" id="bottomNav">
            <button class="nav-item active" data-section="home-section"><i class="bi bi-house-door-fill"></i><span>Home</span></button>
            <button class="nav-item" data-section="earn-section"><i class="bi bi-gem"></i><span>Earn</span></button>
            <button class="nav-item" data-section="posts-section"><i class="bi bi-collection-fill"></i><span>Posts</span></button>
            <button class="nav-item" data-section="profile-section"><i class="bi bi-person-fill"></i><span>Profile</span></button>
        </nav>
        
        <!-- Modals -->
        <!-- Post Details Modal -->
        <div class="modal fade" id="postDetailsModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="postDetailsModalTitle">Post Details</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body" id="postDetailsModalBody">
                        <!-- Post details will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Set Password Modal (for TG users) -->
        <div class="modal fade" id="setPasswordModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Set Web Login Password</h5>
                    </div>
                    <div class="modal-body">
                        <p class="text-secondary">To access your account from a web browser outside of Telegram, please set a password.</p>
                        <form id="setPasswordForm">
                            <div class="mb-3">
                                <label for="newUserPassword" class="form-label">New Password</label>
                                <input type="password" class="form-control" id="newUserPassword" required>
                            </div>
                             <div class="mb-3">
                                <label for="confirmNewUserPassword" class="form-label">Confirm Password</label>
                                <input type="password" class="form-control" id="confirmNewUserPassword" required>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="savePasswordBtn">Save Password</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- JS Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
